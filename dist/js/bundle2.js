var Food=Backbone.Model.extend({defaults:{added:!1}});
!function e(t,o,i){function n(s,a){if(!o[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=o[s]={exports:{}};t[s][0].call(c.exports,function(e){var o=t[s][1][e];return n(o?o:e)},c,c.exports,e,t,o,i)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,t,o){t.exports={displayErrorToUser:function(e,t,o){var i=document.createElement("p");i.setAttribute("class","errorMessage"),i.innerHTML=t,e.appendChild(i),setTimeout(function(){for(;e.firstChild;)e.removeChild(e.firstChild)},o)}}},{}],2:[function(e,t,o){"use strict";var i=i||{},n=e("./helpers"),r=document.getElementById("error");$(document).ready(function(){$(".ui .item").on("click",function(){$(".ui .item").removeClass("active"),$(this).addClass("active")})});var s=Backbone.Collection.extend({model:Food}),a=Backbone.Firebase.Collection.extend({model:Food,url:"https://healthtrackingbbone.firebaseio.com"}),l=Backbone.View.extend({el:$("#main"),initialize:function(){this.render()},events:{"submit form":"fetchData"},fetchData:function(e){e.preventDefault();var t=this,o=$(e.currentTarget).find("input[type=text]").val().trim(),s=o.replace(/ /g,"%20"),a="https://api.nutritionix.com/v1_1/search/"+s+"?results=0%3A20&cal_min=0&cal_max=50000&fields=item_name%2Citem_id%2Cbrand_name%2Cnf_calories%2Cnf_total_fat&appId=b301fa4c&appKey=dc12f0d56ee2507d0393345103cb64fa";0===o.length?n.displayErrorToUser(r,"Type a food keyword please ...",2e3):$.ajax({type:"GET",url:a,dataType:"JSON",success:function(e){if(i.foods.reset(),e&&e.hits.length>0)for(var o,s,a,l,d,c,m,f=0;e.hits.length>f;f++)o=e.hits[f].fields.item_id,s=e.hits[f].fields.brand_name,a=e.hits[f].fields.item_name,l=e.hits[f].fields.nf_calories,d=e.hits[f].fields.nf_serving_size_qty,c=e.hits[f].fields.nf_serving_size_unit,m=e.hits[f].fields.nf_total_fat||"N/A",i.food=new Food({id:o,brandName:s,itemName:a,calories:l,servingSize:d,servingUnit:c,totalFat:m}),i.foods.add(i.food);else n.displayErrorToUser(r,"No Result with the keyword...",2e3);t.render()},error:function(){n.displayErrorToUser(r,"Error on fetching data...",2e3)}})},render:function(){var e=_.template($("#search-page-template").html());this.$el.html(e)}}),d=Backbone.View.extend({el:$("#resultList"),initialize:function(){this.listenTo(this.collection,"add remove",this.render)},render:function(){this.$el.empty();var e,t=this;_(this.collection.models).each(function(o){e=new c({model:o}),t.$el.append(e.render())},this)}}),c=Backbone.View.extend({tagName:"div",className:"item",template:_.template($("#list-item-template").html()),events:{"click .addButton":"addToMyFoods"},render:function(){return this.$el.html(this.template({item:this.model}))},addToMyFoods:function(e){e.preventDefault(),this.model.set("added",!0),i.myFoods.add(this.model),i.foods.remove(this.model)}}),m=Backbone.View.extend({el:"#main",initialize:function(){this.render()},render:function(){var e=_.template($("#myfoods-header-template").html());this.$el.html(e)}}),f=Backbone.View.extend({el:"#resultList",initialize:function(){this.listenTo(this.collection,"sync remove",this.render)},render:function(){this.$el.empty();var e,t=this,o=0;"#/myfoods"===window.location.hash&&(_(t.collection.models).each(function(i){e=new h({collection:t.collection,model:i}),t.$el.append(e.render()),o+=i.get("calories")},this),$("#totalCalories").text(Math.round(100*o)/100))}}),h=Backbone.View.extend({tagName:"div",className:"item",template:_.template($("#list-item-template").html()),events:{"click .removeButton":"removeFromMyFoods"},render:function(){return this.$el.html(this.template({item:this.model}))},removeFromMyFoods:function(e){e.preventDefault(),i.myFoods.remove(this.model)}});i.foods=new s,i.myFoods=new a,i.searchBoxView=new l,i.searchResultView=new d({collection:i.foods}),i.myFoodsHeaderView=new m,i.myFoodsView=new f({collection:i.myFoods});var u=Backbone.Router.extend({routes:{"":"search",myfoods:"myfoods"},search:function(){i.searchBoxView.render(),i.foods.reset(),i.searchResultView.render()},myfoods:function(){i.myFoodsHeaderView.render(),i.myFoodsView.render()}});i.router=new u,Backbone.history.start()},{"./helpers":1}]},{},[2]);